
# SELinux in RedHat Enterprise Linux
SELinux(Security Enhanced Linux)


SELinux is a set of security rules that determine which process can access which files, 
directories, and ports. Every file, process, directory, and port has a special security label called a 
SELinux context. A context is a name that is used by the SELinux policy to determine whether a 
process can access a file, directory, or port.

### We have two types of security 
- Discretionary Access Control(DAC)
- Mandatory Access Control(MAC)

#### To check the status of SELinux
```
	#sestatus
```
### SELinux has three modes 
- Enforcing mode
- Permissive mode
- Disabled mode

#### To display current SELinux mode
```
	#getenforce
```
#### To change or set or modify current mode (Temporary)
```
	# setenforce 0/1
```
[ 0 means permissive mode and 1 means Enforcing mode or enabled SELinux]

#### If we want to change parmanently then we have to edit etc/selinux/config  file

Setting the default SELinux mode use /etc/selinux/config command to change default mode at boot time.
```
[root@RHEL ~]# cat /etc/selinux/config
```

	# This file controls the state of SELinux on the system.
	# SELINUX= can take one of these three values:
	#     enforcing - SELinux security policy is enforced.
	#     permissive - SELinux prints warnings instead of enforcing.
	#     disabled - No SELinux policy is loaded.
	SELINUX=enforcing
	# SELINUXTYPE= can take one of these three values:
	#     targeted - Targeted processes are protected,
	#     minimum - Modification of targeted policy. Only selected processes are protected.
	#     mls - Multi Level Security protection.
	SELINUXTYPE=targeted


## SELinux context

the SELinux context of a file's parent directory determines its initial SELinux context.
the context of the parent directory is assigned to the newly created into the directory file.

Context is a predefined policy/role

	SELinux context syntax

	[root@RHEL ~]# ll -dZ /root
	dr-xr-x---. 14 root root system_u:object_r:admin_home_t:s0 4096 Mar 26 04:12 /root

	user:role:type/target:security level

#### To see SELinux context add Z flag to the commnad

- chcon command 

	this command use to change the selinux context temporary. 
When reboot your machine this change automatically removed
```
	# chcon -t context file/folder path
	# chcon -t var_t /data
```
	Example:
	[root@RHEL ~]# mkdir /data
	[root@RHEL ~]# ll -dZ /data
	drwxr-xr-x. 2 root root unconfined_u:object_r:default_t:s0 6 Mar 30 10:28 /data
	[root@RHEL ~]# ll -dZ /var
	drwxr-xr-x. 22 root root system_u:object_r:var_t:s0 4096 Mar 24 20:57 /var
	[root@RHEL ~]# chcon -t var_t /data
	[root@RHEL ~]# ll -dZ /data
	drwxr-xr-x. 2 root root unconfined_u:object_r:var_t:s0 6 Mar 30 10:28 /data
	[root@RHEL ~]#

- restorecon command

this command used to set default file context

	[root@RHEL ~]# restorecon -v /data
	Relabeled /data from unconfined_u:object_r:var_t:s0 to unconfined_u:object_r:default_t:s0
	[root@RHEL ~]#

- "semanage fcontext" command
	this command used to change the selinux context parmanently.
```
	#semanage fcontext -a -t context file/folder path 
```
[ -a means all file or folder .. to see all flags wirte] 
```
	#semanage fcontext --help
	#man semanage fcontext 
```
#### semanage fcontext entry file location
```
	# cat /etc/selinux/targeted/contexts/files/file_contexts.local
```	
	Example: 
	[root@RHEL ~]# semanage fcontext -a -t default_t /var/test
	[root@RHEL ~]# cat /etc/selinux/targeted/contexts/files/file_contexts.local
	# This file is auto-generated by libsemanage
	# Do not edit directly.

	/var/test    system_u:object_r:default_t:s0
	[root@RHEL ~]#
  
#### To complete semanage fcontext must be run 
```
	# restorecon -Rvvv /var/test
```
[ with R option means recursively and multiple v option means varbose details]

#### Only user can see his own context by id command

	[root@RHEL ~]# id
	uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfi     ned_t:s0-s0:c0.c1023
	[root@RHEL ~]# id sifat
	uid=1000(sifat) gid=1000(sifat) groups=1000(sifat)

## SELinux Booleans

getsebool command is used to display SELinux Booleans and setsebool is used to modify them.

#### To see available all booleans status
```
	#getseboole -a 
```
#### To see available all booleans status with details description
```
	#semanage boolean -l 
```
#### To see current modified booleans 
```
	#semanage boolean -l -C
```
#### To see specific boolean status
```
	#getsebool booleans name
```
	Example:
	[root@RHEL ~]# getsebool abrt_anon_write
	abrt_anon_write --> off
	[root@RHEL ~]#

#### To see specific boolean status details

	[root@RHEL ~]# semanage boolean -l| grep  ssh_sysadm_login
	ssh_sysadm_login               (off  ,  off)  Allow ssh to sysadm login
	[root@RHEL ~]#


#### To change or set booleans
```
	#setsebool boolean name value[on or off/1 or 0]
```
#### To change or set booleans parmanently
```
	# setsebool -P boolean name value
```
	Example:
	[root@RHEL ~]# setsebool samba_share_nfs  1
	[root@RHEL ~]# semanage boolean -l | grep samba_share_nfs
	samba_share_nfs                (on   ,  off)  Allow samba to share nfs
	[root@RHEL ~]# setsebool -P samba_share_nfs  1
	[root@RHEL ~]# semanage boolean -l | grep samba_share_nfs
	samba_share_nfs                (on   ,   on)  Allow samba to share nfs
	[root@RHEL ~]#


### Thank You

##### If you have any feedback, please reach out to me at mdsifathossain100@gmail.com
[![linkedin](https://img.shields.io/badge/linkedin-0A66C2?style=for-the-badge&logo=linkedin&logoColor=white)](https://www.linkedin.com/in/md-sifat-hossain-461274184/)
[![twitter](https://img.shields.io/badge/twitter-1DA1F2?style=for-the-badge&logo=twitter&logoColor=white)](https://twitter.com/ict_all)

[@sifat](https://github.com/MdsifatHossain)
